%define base_version trunk
Name: 		gnome2-globalmenu-applet
Version: 	%{base_version}.@SVNVERSION@
Release:	4%{?dist}
Summary:	Global menubar applet for Gnome2

Group:		User Interface/Desktops
License:	GPLv2+
URL:		http://code.google.com/p/gnome2-globalmenu/

Source0:	http://gnome2-globalmenu.googlecode.com/files/gnome2-globalmenu-applet-%{base_version}.tar.gz
BuildRoot:      %{_tmppath}/%{name}-%{base_version}-%{release}-root-%(%{__id_u} -n)

Requires:	gtk2-aqd
Requires:	libwnck

%description
A panel applet, if the user has installed gtk2-aqd, the menubar of current activated window will be shown in the applet instead of the window; the menubar of unactivated window will disappear.

%prep
%setup -q -n gnome2-globalmenu-applet-%{base_version}

%build
%configure
make

%install
rm -rf %{buildroot}
make DESTDIR=%{buildroot} install

%clean
rm -rf %{buildroot}

%pre
export GCONF_CONFIG_SOURCE=`gconftool-2 --get-default-source`
gconftool-2 --makefile-uninstall-rule %{_sysconfdir}/gconf/schemas/gnome2-globalmenu-applet.schema  >& /dev/null || :

%post
export GCONF_CONFIG_SOURCE=`gconftool-2 --get-default-source`
gconftool-2 --makefile-install-rule %{_sysconfdir}/gconf/schemas/gnome2-globalmenu-applet.schema >& /dev/null || :

%preun
export GCONF_CONFIG_SOURCE=`gconftool-2 --get-default-source`
gconftool-2 --makefile-uninstall-rule %{_sysconfdir}/gconf/schemas/gnome2-globalmenu-applet.schema >& /dev/null || :


%files
%defattr(-, root, root)

%doc %{_docdir}/%{name}/README 
%doc %{_docdir}/%{name}/AUTHORS
%doc %{_docdir}/%{name}/COPYING 
%doc %{_docdir}/%{name}/ChangeLog
%doc %{_docdir}/%{name}/INSTALL 
%doc %{_docdir}/%{name}/NEWS
%doc %{_docdir}/%{name}/GNOME_GlobalMenuApplet.server.sample
#%doc README AUTHORS COPYING ChangeLog INSTALL NEWS
#%doc GNOME_GlobalMenuApplet.server.sample
%{_libexecdir}/gnome2-globalmenu-applet
%{_libdir}/bonobo/servers/GNOME_GlobalMenuApplet.server
%{_datadir}/xfce4/panel-plugins/gnome2-globalmenu-applet.desktop
%{_libexecdir}/xfce4-globalmenu-plugin
%{_sysconfdir}/gconf/schemas/gnome2-globalmenu-applet.schema

%changelog 
* Mon Jan 14 2008 Feng Yu <rainwoodman@gmail.com>
- Added schema
* Wed Jan 09 2008 Feng Yu <rainwoodman@gmail.com>
- Added description
